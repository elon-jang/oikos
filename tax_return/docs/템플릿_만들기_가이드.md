# 기부금 영수증 템플릿 만들기 가이드

이 가이드를 따라 귀 단체에 맞는 기부금 영수증 템플릿을 만들 수 있습니다.

## 개요

템플릿은 Word 문서(`.docx`)로 작성하며, `{{변수명}}` 형식의 placeholder를 사용합니다.

## 필수 Placeholder

템플릿에 반드시 포함해야 하는 placeholder입니다.

| Placeholder | 설명 | 예시 |
|-------------|------|------|
| `{{receipt_no}}` | 발급번호 | 26-001 |
| `{{name}}` | 기부자 성명 | 홍길동 |
| `{{month_1}}` ~ `{{month_12}}` | 월별 금액 | 100,000 |
| `{{total}}` | 연간 총합 | 1,200,000 |

## 템플릿 작성 단계

### 1단계: Word 문서 생성

1. Microsoft Word 또는 한글 오피스에서 새 문서 생성
2. 페이지 설정: A4, 세로 방향

### 2단계: 기본 레이아웃 작성

기부금 영수증에 필요한 기본 내용을 작성합니다.

```
기부금 영수증

발급번호: {{receipt_no}}

1. 기부자
   성명: {{name}}
   주민등록번호: (빈칸)
   주소: (빈칸)

2. 기부금 단체
   단체명: [귀 단체명]
   사업자등록번호: [사업자번호]
   소재지: [주소]

3. 기부 내역
   [월별 금액 표]

4. 기부금 총액: {{total}}원

위와 같이 기부금을 수령하였음을 증명합니다.

20XX년  월  일

[단체명] 대표 [대표자명] (직인)
```

### 3단계: 월별 금액 표 만들기

표를 삽입하고 월별 금액을 입력합니다.

| 월 | 금액 |
|----|------|
| 1월 | `{{month_1}}` |
| 2월 | `{{month_2}}` |
| 3월 | `{{month_3}}` |
| 4월 | `{{month_4}}` |
| 5월 | `{{month_5}}` |
| 6월 | `{{month_6}}` |
| 7월 | `{{month_7}}` |
| 8월 | `{{month_8}}` |
| 9월 | `{{month_9}}` |
| 10월 | `{{month_10}}` |
| 11월 | `{{month_11}}` |
| 12월 | `{{month_12}}` |
| **합계** | `{{total}}` |

### 4단계: 파일 저장

파일명: `donation_receipt_template.docx`

## 주의사항

### Placeholder 문법
- 반드시 `{{` 와 `}}` 로 감싸야 합니다
- 변수명은 정확히 입력해야 합니다 (대소문자 구분)
- 공백 없이 입력: `{{name}}` ✅, `{{ name }}` ❌

### 레이아웃
- A4 한 장에 맞게 여백과 폰트 크기를 조절하세요
- 표의 셀 병합 시 placeholder가 분리되지 않도록 주의하세요

### 테스트
템플릿 작성 후 반드시 테스트하세요:

```bash
python generate_receipts.py -n 홍길동 --data sample_income_summary.xlsx
```

## 예시 템플릿 구조

```
┌─────────────────────────────────────────┐
│           기 부 금 영 수 증              │
│                                         │
│  발급번호: {{receipt_no}}               │
├─────────────────────────────────────────┤
│  기부자 정보                             │
│  성명: {{name}}                         │
│  주민등록번호:                           │
│  주소:                                  │
├─────────────────────────────────────────┤
│  기부금 단체 정보                        │
│  단체명: OO교회                          │
│  사업자등록번호: 000-00-00000           │
├─────────────────────────────────────────┤
│  월별 기부 내역                          │
│  ┌────┬──────────┐                      │
│  │ 월 │   금액   │                      │
│  ├────┼──────────┤                      │
│  │1월 │{{month_1}}│                      │
│  │... │   ...    │                      │
│  │합계│{{total}} │                      │
│  └────┴──────────┘                      │
├─────────────────────────────────────────┤
│  위와 같이 기부금을 수령하였음을          │
│  증명합니다.                             │
│                                         │
│  20XX년  월  일                          │
│                                         │
│  OO교회 담임목사 OOO (인)                │
└─────────────────────────────────────────┘
```

## 공식 양식 참고

국세청 기부금 영수증 공식 양식을 참고하세요:
- 소득세법 시행규칙 [별지 제45호의2서식]
- 국세청 홈택스에서 양식 다운로드 가능

## 문제 해결

### 오류: TemplateSyntaxError
- `}}` 누락 여부 확인
- 중괄호가 Word에서 자동 변환되었는지 확인 (스마트 따옴표 끄기)

### 금액이 표시되지 않음
- placeholder 변수명이 정확한지 확인
- `{{month_1}}` ~ `{{month_12}}`, `{{total}}` 확인

### 레이아웃이 깨짐
- 표 셀 안에 placeholder를 넣을 때 셀을 병합하지 마세요
- 글꼴이 설치되어 있는지 확인하세요
