# 기부금 영수증 자동 발행 시스템 - 시작하기 가이드

> **"5분 만에 100명분 영수증 발행!"**
>
> 매년 1월, 수백 명의 영수증을 하나하나 만드느라 밤새우셨나요?
> 이제 그 시간을 줄여드릴게요.

---

## 어떤 방법이 좋을까요?

| 방법 | 이런 분께 추천 | 난이도 |
|------|---------------|--------|
| [Claude Desktop + Docker](#방법-1-claude-desktop--docker-가장-쉬움) | 컴퓨터 잘 모르시는 분, **가장 쉬움!** | ⭐ |
| [Claude Code](#방법-2-claude-code) | 개발자, CLI 익숙한 분 | ⭐⭐ |
| [Python 직접 실행](#방법-3-python-직접-실행) | 개발자, 커스터마이징 원하시는 분 | ⭐⭐⭐ |

**추천**: 처음이시라면 **방법 1 (Claude Desktop + Docker)**부터 시작하세요!

---

## 방법 1: Claude Desktop + Docker (가장 쉬움)

> **"Claude야, 영수증 만들어줘!"** 한마디면 끝!

### Step 1: Docker Desktop 설치

Docker는 프로그램을 쉽게 실행할 수 있게 해주는 도구예요.

1. [Docker Desktop 다운로드](https://www.docker.com/products/docker-desktop/) 페이지 방문
2. 운영체제(Mac/Windows)에 맞는 버전 다운로드
3. 다운로드한 파일 실행해서 설치
4. 설치 완료 후 Docker Desktop 실행 (처음엔 1-2분 걸려요)

> **설치 확인**: 화면 우측 상단(Mac) 또는 작업 표시줄(Windows)에 고래 모양 아이콘이 보이면 성공!

### Step 2: 영수증 시스템 설치

#### Mac 사용자

1. **터미널 열기**: `Cmd + Space` 누르고 "터미널" 입력 후 Enter
2. **아래 명령어 복사해서 붙여넣기**:
   ```bash
   curl -sL https://raw.githubusercontent.com/elon-jang/oikos/master/tax_return/deploy/install.sh | bash
   ```
3. **Enter 누르고 기다리기** (1-2분)

#### Windows 사용자

1. **PowerShell 열기**: `Win + X` → "Windows PowerShell (관리자)" 선택
2. **아래 명령어 복사해서 붙여넣기**:
   ```powershell
   irm https://raw.githubusercontent.com/elon-jang/oikos/master/tax_return/deploy/install.ps1 | iex
   ```
3. **Enter 누르고 기다리기**

### Step 3: 데이터 파일 준비

설치가 완료되면 새 폴더가 생성됩니다:
- Mac: `~/기부금영수증/`
- Windows: `내 문서\기부금영수증\`

이 폴더에 두 가지 파일을 넣어주세요:

#### 1) 헌금 데이터 파일

엑셀 파일명: `2025_income_summary.xlsx` (연도에 맞게)

| 이름 | 1월 | 2월 | ... | 12월 | 연간 총합 |
|------|-----|-----|-----|------|----------|
| 홍길동 | 100,000 | 100,000 | ... | 100,000 | 1,200,000 |
| 김영희 | 50,000 | 50,000 | ... | 50,000 | 600,000 |

**팁**: 부부가 함께 헌금하면 `홍길동,김영희` 처럼 쉼표로 구분하세요. 각각 영수증이 발행됩니다!

#### 2) 영수증 템플릿

Word 파일명: `donation_receipt_template.docx`

템플릿 만드는 방법은 [템플릿_만들기_가이드.md](템플릿_만들기_가이드.md)를 참고하세요.

### Step 4: Claude Desktop 시작!

1. **Claude Desktop 재시작** (설치 후 꼭 재시작해야 해요!)
2. **대화 시작**:

```
나: 영수증 발행 대상자가 몇 명이야?
Claude: 총 94명의 대상자가 있어요. 전체 헌금 총액은 45,000,000원입니다.

나: 홍길동 영수증 발행해줘
Claude: 홍길동님 영수증이 생성되었어요!
        파일: ~/기부금영수증/receipts/기부금영수증_홍길동.docx

나: 전체 영수증 발행해줘
Claude: 94명의 영수증을 생성할게요. 진행할까요?

나: 응!
Claude: 완료! 📁 receipts 폴더에 94개의 영수증이 생성되었어요.
```

**끝!** 이게 전부예요. `receipts` 폴더에서 영수증을 확인하고 인쇄하시면 됩니다.

---

## 방법 2: Claude Code

> 개발자라면 `/receipt` 명령어로 더 빠르게!

### Step 1: Claude Code 설치

#### Mac

```bash
# Node.js가 없다면 먼저 설치
brew install node

# Claude Code 설치
npm install -g @anthropic-ai/claude-code

# 설치 확인
claude --version
```

#### Windows

1. [nodejs.org](https://nodejs.org)에서 Node.js 다운로드 및 설치
2. 명령 프롬프트에서:
   ```bash
   npm install -g @anthropic-ai/claude-code
   ```

### Step 2: 프로젝트 다운로드

```bash
# 원하는 폴더에서
git clone https://github.com/elon-jang/oikos.git
cd oikos/tax_return
```

> **git이 없다면?** [GitHub 페이지](https://github.com/elon-jang/oikos)에서 "Download ZIP" 클릭!

### Step 3: 파이썬 패키지 설치

```bash
pip3 install pandas openpyxl docxtpl pyyaml
```

### Step 4: 사용하기

```bash
# Claude Code 실행
claude

# 또는 직접 명령어 실행
python generate_receipts.py --list              # 대상자 목록
python generate_receipts.py -n 홍길동            # 특정인 발행
python generate_receipts.py                     # 전체 발행
```

**Claude Code에서 말로 요청해도 돼요:**

```
"대상자 목록 보여줘"
"홍길동 영수증 발행해줘"
"전체 영수증 발행하고 결과 알려줘"
```

---

## 방법 3: Python 직접 실행

> 완전한 컨트롤을 원하시는 분께!

### Step 1: Python 설치

```bash
# Mac
brew install python3

# Windows: https://python.org 에서 다운로드
```

### Step 2: 프로젝트 다운로드

```bash
git clone https://github.com/elon-jang/oikos.git
cd oikos/tax_return
```

### Step 3: 패키지 설치

```bash
pip3 install pandas openpyxl docxtpl pyyaml

# PDF 변환이 필요하다면 (선택)
pip3 install docx2pdf  # Microsoft Word 필요
# 또는
brew install libreoffice  # Mac
```

### Step 4: 사용하기

```bash
# 대상자 목록 확인
python generate_receipts.py --list

# 전체 발행
python generate_receipts.py

# 특정인 발행
python generate_receipts.py -n 홍길동

# 여러 명 발행
python generate_receipts.py -n 홍길동,김영희,이철수

# 발행 이력 확인
python generate_receipts.py --history

# 다른 데이터 파일 사용
python generate_receipts.py --data 2024_income_summary.xlsx

# 다른 템플릿 사용
python generate_receipts.py --template my_template.docx

# PDF로 변환
python generate_receipts.py --pdf
```

---

## 템플릿 만들기 (모든 방법 공통)

영수증의 틀이 되는 Word 문서가 필요해요.

### 필수 placeholder

템플릿에 이 내용들을 넣어두면 자동으로 값이 채워집니다:

| placeholder | 설명 | 예시 |
|-------------|------|------|
| `{{receipt_no}}` | 발급번호 | 26-001 |
| `{{name}}` | 기부자 이름 | 홍길동 |
| `{{month_1}}` ~ `{{month_12}}` | 월별 금액 | 100,000 |
| `{{total}}` | 연간 총합 | 1,200,000 |

### 간단 예시

```
┌─────────────────────────────────────────┐
│           기 부 금 영 수 증              │
│                                         │
│  발급번호: {{receipt_no}}               │
├─────────────────────────────────────────┤
│  기부자 성명: {{name}}                   │
├─────────────────────────────────────────┤
│  기부 내역                               │
│  1월: {{month_1}}   7월: {{month_7}}    │
│  2월: {{month_2}}   8월: {{month_8}}    │
│  ...                                     │
│  합계: {{total}}                        │
├─────────────────────────────────────────┤
│  위와 같이 기부금을 수령하였음을 증명합니다. │
│  2026년  월  일                          │
│  OO교회 담임목사 OOO (인)                │
└─────────────────────────────────────────┘
```

파일명: `donation_receipt_template.docx`

> **자세한 가이드**: [템플릿_만들기_가이드.md](템플릿_만들기_가이드.md) 참고

---

## 문제 해결

### "템플릿 파일이 없습니다"

**해결**: `donation_receipt_template.docx` 파일을 만들어서 같은 폴더에 넣으세요.

### "데이터 파일을 찾을 수 없습니다"

**해결**:
- `2025_income_summary.xlsx` 형식의 파일이 있는지 확인
- 또는 `--data 파일명.xlsx` 옵션으로 직접 지정

### "필수 컬럼이 없습니다"

**해결**: 엑셀 파일 컬럼명 확인
- 필수: `이름`, `1월`~`12월`, `연간 총합`

### "npm: command not found"

**해결**: Node.js 설치 필요
- Mac: `brew install node`
- Windows: [nodejs.org](https://nodejs.org)

### "python: command not found"

**해결**: Python 설치 필요
- Mac: `brew install python3`
- Windows: [python.org](https://python.org)

### "ModuleNotFoundError"

**해결**: 패키지 설치
```bash
pip3 install pandas openpyxl docxtpl
```

---

## 자주 쓰는 명령어 모음

| 하고 싶은 것 | 명령어 |
|-------------|--------|
| 대상자 목록 보기 | `python generate_receipts.py --list` |
| 전체 영수증 발행 | `python generate_receipts.py` |
| 홍길동만 발행 | `python generate_receipts.py -n 홍길동` |
| 여러 명 발행 | `python generate_receipts.py -n 홍길동,김영희` |
| 발행 이력 확인 | `python generate_receipts.py --history` |
| PDF로 변환 | `python generate_receipts.py --pdf` |

---

## 연간 작업 순서

### 1단계: 데이터 정리 (12월 말 ~ 1월 초)

- 헌금 데이터 정리
- 이름 오타 수정, 통합
- 비개인 항목 제외 (무명, 셀 등)

### 2단계: 영수증 발행 (1월)

```bash
# 대상자 확인
python generate_receipts.py --list

# 전체 발행
python generate_receipts.py
```

### 3단계: 검증

- 생성된 영수증 샘플 확인
- 인원수 확인 (부부 분리 반영)

### 4단계: 배포

- 인쇄 또는 이메일 발송

---

## 더 알아보기

| 문서 | 설명 |
|------|------|
| [README.md](../README.md) | 모든 기능 상세 설명 |
| [템플릿_만들기_가이드.md](템플릿_만들기_가이드.md) | 템플릿 작성법 |
| [MCP_사용가이드.md](MCP_사용가이드.md) | Claude Desktop 연동 |
| [DOCKER.md](DOCKER.md) | Docker 상세 설정 |

---

**문의사항이 있으시면 GitHub Issues에 남겨주세요:**
https://github.com/elon-jang/oikos/issues

**Made with love for church communities**
