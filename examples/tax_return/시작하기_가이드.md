# 기부금 영수증 자동 발행 시스템 - 시작하기 가이드

처음 사용하시는 분을 위한 단계별 안내입니다. Claude Code 설치부터 영수증 생성까지 전 과정을 설명합니다.

---

## 목차

1. [사전 준비](#1-사전-준비)
2. [Claude Code 설치](#2-claude-code-설치)
3. [프로젝트 다운로드](#3-프로젝트-다운로드)
4. [Python 환경 설정](#4-python-환경-설정)
5. [샘플로 테스트하기](#5-샘플로-테스트하기)
6. [템플릿 만들기](#6-템플릿-만들기)
7. [헌금 데이터 준비](#7-헌금-데이터-준비)
8. [영수증 생성](#8-영수증-생성)
9. [문제 해결](#9-문제-해결)

---

## 1. 사전 준비

### 필요한 것

- **컴퓨터**: macOS 또는 Windows
- **인터넷 연결**
- **Anthropic 계정**: [console.anthropic.com](https://console.anthropic.com)에서 가입
- **헌금 데이터**: Excel 파일 (월별 헌금 내역)

### 예상 소요 시간

- 최초 설정: 약 30분
- 이후 영수증 생성: 5분 이내

---

## 2. Claude Code 설치

### macOS

#### 2.1 터미널 열기

1. `Cmd + Space`를 눌러 Spotlight 검색 열기
2. "터미널" 입력 후 Enter

또는 `Finder > 응용 프로그램 > 유틸리티 > 터미널`

#### 2.2 Claude Code 설치

터미널에 아래 명령어를 복사하여 붙여넣고 Enter를 누르세요.

```bash
npm install -g @anthropic-ai/claude-code
```

> **npm이 없다면?**
> 먼저 Node.js를 설치하세요:
> ```bash
> # Homebrew가 있다면
> brew install node
>
> # 없다면 https://nodejs.org 에서 다운로드
> ```

#### 2.3 설치 확인

```bash
claude --version
```

버전 번호가 표시되면 설치 성공입니다.

### Windows

#### 2.1 명령 프롬프트 열기

1. `Win + R`을 눌러 실행 창 열기
2. "cmd" 입력 후 Enter

#### 2.2 Claude Code 설치

```bash
npm install -g @anthropic-ai/claude-code
```

> **npm이 없다면?**
> [nodejs.org](https://nodejs.org)에서 Node.js를 다운로드하여 설치하세요.

---

## 3. 프로젝트 다운로드

### 3.1 작업 폴더 생성

원하는 위치에 폴더를 만듭니다.

```bash
# macOS/Linux
mkdir -p ~/Documents/church
cd ~/Documents/church

# Windows
mkdir C:\Users\사용자명\Documents\church
cd C:\Users\사용자명\Documents\church
```

### 3.2 프로젝트 다운로드

```bash
git clone https://github.com/elon-jang/oikos.git
cd oikos/examples/tax_return
```

> **git이 없다면?**
>
> **방법 1**: git 설치
> - macOS: `brew install git`
> - Windows: [git-scm.com](https://git-scm.com) 에서 다운로드
>
> **방법 2**: 직접 다운로드
> 1. https://github.com/elon-jang/oikos 접속
> 2. 녹색 "Code" 버튼 클릭
> 3. "Download ZIP" 클릭
> 4. 압축 해제 후 `examples/tax_return` 폴더로 이동

### 3.3 폴더 구조 확인

```bash
ls -la
```

다음 파일들이 보여야 합니다:
```
generate_receipts.py          # 영수증 생성 스크립트
sample_income_summary.xlsx    # 샘플 데이터
config.sample.yaml            # 설정 파일 샘플
템플릿_만들기_가이드.md         # 템플릿 작성 가이드
README.md                     # 설명서
```

---

## 4. Python 환경 설정

### 4.1 Python 설치 확인

```bash
python3 --version
```

`Python 3.x.x`가 표시되면 설치되어 있습니다.

> **Python이 없다면?**
> - macOS: `brew install python3`
> - Windows: [python.org](https://python.org) 에서 다운로드

### 4.2 필요한 패키지 설치

```bash
pip3 install pandas openpyxl docxtpl pyyaml
```

설치 확인:
```bash
python3 -c "import pandas; import docxtpl; print('설치 완료!')"
```

---

## 5. 샘플로 테스트하기

실제 데이터를 사용하기 전에 샘플로 테스트해봅니다.

### 5.1 Claude Code 실행

```bash
claude
```

처음 실행하면 API 키를 입력하라고 합니다.
[console.anthropic.com](https://console.anthropic.com)에서 API 키를 복사하여 붙여넣으세요.

### 5.2 대상자 목록 확인

Claude Code에서 다음과 같이 입력하세요:

```
샘플 데이터로 대상자 목록을 보여줘

python generate_receipts.py --list --data sample_income_summary.xlsx
```

결과 예시:
```
데이터 파일: sample_income_summary.xlsx (발급연도: 26)
총 14명:
    1. 강미래 (1,440,000원)
    2. 김영희 (600,000원)
    ...
```

### 5.3 샘플 영수증 생성

```
홍길동 영수증만 생성해줘

python generate_receipts.py -n 홍길동 --data sample_income_summary.xlsx
```

`receipts/` 폴더에 `기부금영수증_홍길동.docx` 파일이 생성됩니다.

> **주의**: 샘플 테스트에서는 템플릿 파일이 없으면 오류가 발생합니다.
> 먼저 [6. 템플릿 만들기](#6-템플릿-만들기)를 진행하세요.

---

## 6. 템플릿 만들기

### 6.1 템플릿이란?

영수증의 틀이 되는 Word 문서입니다. `{{name}}`과 같은 placeholder를 넣어두면, 프로그램이 자동으로 실제 값으로 채워줍니다.

### 6.2 Word에서 템플릿 만들기

1. **Microsoft Word** 또는 **한글**을 엽니다
2. 새 문서를 만듭니다
3. 아래 내용을 참고하여 영수증 양식을 작성합니다

### 6.3 필수 placeholder

템플릿에 반드시 포함해야 하는 placeholder입니다:

| placeholder | 설명 | 실제 값 예시 |
|-------------|------|-------------|
| `{{receipt_no}}` | 발급번호 | 26-001 |
| `{{name}}` | 기부자 성명 | 홍길동 |
| `{{month_1}}` | 1월 금액 | 100,000 |
| `{{month_2}}` | 2월 금액 | 100,000 |
| ... | ... | ... |
| `{{month_12}}` | 12월 금액 | 100,000 |
| `{{total}}` | 연간 총합 | 1,200,000 |

### 6.4 템플릿 예시

```
┌─────────────────────────────────────────┐
│           기 부 금 영 수 증              │
│                                         │
│  발급번호: {{receipt_no}}               │
├─────────────────────────────────────────┤
│  1. 기부자                               │
│     성명: {{name}}                       │
│     주민등록번호:                         │
│     주소:                                │
├─────────────────────────────────────────┤
│  2. 기부금 단체                          │
│     단체명: OO교회                        │
│     사업자등록번호: 000-00-00000         │
├─────────────────────────────────────────┤
│  3. 기부 내역                            │
│     ┌────┬──────────┐                   │
│     │ 월 │   금액   │                   │
│     ├────┼──────────┤                   │
│     │1월 │{{month_1}}│                   │
│     │2월 │{{month_2}}│                   │
│     │... │   ...    │                   │
│     │12월│{{month_12}}│                  │
│     ├────┼──────────┤                   │
│     │합계│{{total}} │                    │
│     └────┴──────────┘                   │
├─────────────────────────────────────────┤
│  위와 같이 기부금을 수령하였음을          │
│  증명합니다.                             │
│                                         │
│  2026년  월  일                          │
│                                         │
│  OO교회 담임목사 OOO (인)                │
└─────────────────────────────────────────┘
```

### 6.5 템플릿 저장

파일명: `donation_receipt_template.docx`
저장 위치: `tax_return` 폴더 (generate_receipts.py와 같은 폴더)

> **자세한 가이드**: `템플릿_만들기_가이드.md` 파일을 참고하세요.

---

## 7. 헌금 데이터 준비

### 7.1 Excel 파일 형식

파일명: `2025_income_summary.xlsx` (연도에 맞게 변경)

| 이름 | 1월 | 2월 | ... | 12월 | 연간 총합 |
|------|-----|-----|-----|------|----------|
| 홍길동 | 100000 | 100000 | ... | 100000 | 1200000 |
| 김영희 | 50000 | 50000 | ... | 50000 | 600000 |
| 홍길동,김영희 | 200000 | 200000 | ... | 200000 | 2400000 |
| 합계 | 350000 | 350000 | ... | 350000 | 4200000 |

### 7.2 주의사항

- **컬럼명 정확히**: `이름`, `1월`, `2월`, ..., `12월`, `연간 총합`
- **부부는 쉼표로 구분**: `홍길동,김영희` → 각각 별도 영수증 발행
- **합계 행**: 마지막 행에 "합계"라고 적으면 자동으로 제외됨
- **빈칸은 0으로 처리**: 헌금이 없는 달은 비워두면 됩니다

### 7.3 파일 저장

저장 위치: `tax_return` 폴더
파일명 형식: `연도_income_summary.xlsx` (예: `2025_income_summary.xlsx`)

---

## 8. 영수증 생성

### 8.1 Claude Code 실행

터미널에서 `tax_return` 폴더로 이동 후:

```bash
claude
```

### 8.2 대상자 목록 확인

```
기부금 영수증 대상자 목록을 보여줘
```

또는 직접:

```bash
python generate_receipts.py --list
```

### 8.3 전체 영수증 발행

```
전체 기부금 영수증을 발행해줘
```

또는:

```bash
python generate_receipts.py
```

### 8.4 특정인만 발행

```
홍길동 기부금 영수증을 발행해줘
```

또는:

```bash
python generate_receipts.py -n 홍길동
```

### 8.5 여러 명 발행

```
홍길동, 김영희, 이철수 영수증을 발행해줘
```

또는:

```bash
python generate_receipts.py -n 홍길동,김영희,이철수
```

### 8.6 발행 이력 확인

```
발행 이력을 보여줘
```

또는:

```bash
python generate_receipts.py --history
```

### 8.7 결과 확인

생성된 영수증은 `receipts/` 폴더에 저장됩니다.

```bash
ls receipts/
```

```
기부금영수증_강미래.docx
기부금영수증_김영희.docx
기부금영수증_홍길동.docx
...
```

---

## 9. 문제 해결

### "템플릿 파일이 없습니다"

```
❌ 오류: 템플릿 파일이 없습니다: donation_receipt_template.docx
```

**해결**: [6. 템플릿 만들기](#6-템플릿-만들기)를 참고하여 템플릿을 만드세요.

### "데이터 파일을 찾을 수 없습니다"

```
❌ 오류: 데이터 파일을 찾을 수 없습니다.
```

**해결**:
- `YYYY_income_summary.xlsx` 파일이 있는지 확인
- 파일명 형식이 맞는지 확인 (예: `2025_income_summary.xlsx`)
- 또는 `--data 파일명.xlsx` 옵션으로 직접 지정

### "필수 컬럼이 없습니다"

```
❌ 오류: 필수 컬럼이 없습니다: 연간 총합
```

**해결**: Excel 파일의 컬럼명을 확인하세요.
필수 컬럼: `이름`, `1월`~`12월`, `연간 총합`

### "npm: command not found"

**해결**: Node.js를 설치하세요.
- macOS: `brew install node`
- Windows: [nodejs.org](https://nodejs.org) 에서 다운로드

### "python: command not found"

**해결**: Python을 설치하세요.
- macOS: `brew install python3`
- Windows: [python.org](https://python.org) 에서 다운로드

### "ModuleNotFoundError: No module named 'pandas'"

**해결**: 필요한 패키지를 설치하세요.
```bash
pip3 install pandas openpyxl docxtpl
```

---

## 부록: 자주 쓰는 명령어 모음

| 작업 | 명령어 |
|------|--------|
| 대상자 목록 | `python generate_receipts.py --list` |
| 전체 발행 | `python generate_receipts.py` |
| 특정인 발행 | `python generate_receipts.py -n 홍길동` |
| 여러 명 발행 | `python generate_receipts.py -n 홍길동,김영희` |
| 발행 이력 | `python generate_receipts.py --history` |
| 특정인 이력 | `python generate_receipts.py --history -n 홍길동` |
| PDF 변환 | `python generate_receipts.py --pdf` |
| 연도 지정 | `python generate_receipts.py --year 2024` |
| 파일 지정 | `python generate_receipts.py --data 파일.xlsx` |

---

## 부록: Claude Code에서 말로 요청하기

Claude Code에서는 명령어를 외울 필요 없이 말로 요청할 수 있습니다.

**예시:**

```
대상자 목록 보여줘
```

```
홍길동 영수증 발행해줘
```

```
전체 영수증 발행하고 결과 알려줘
```

```
작년 발행 이력 확인해줘
```

```
김영희가 올해 낸 헌금 총액이 얼마야?
```

Claude가 적절한 명령어를 실행하고 결과를 알려줍니다.

---

## 다음 단계

1. **매년 연초**: 새 연도 데이터 파일 준비 (`2026_income_summary.xlsx`)
2. **템플릿 연도 수정**: 필요시 템플릿의 연도 업데이트
3. **발행 후**: `receipts/` 폴더의 파일 인쇄 또는 이메일 발송

문의사항이 있으면 GitHub Issues에 남겨주세요:
https://github.com/elon-jang/oikos/issues
