# 기부금 영수증 시스템 - 기능 추가 계획

## 추가 예정 기능
1. **발행 이력/대장 관리**
2. **연도 자동 설정**

---

## 1. 발행 이력/대장 관리

### 개요
영수증 발행 시 자동으로 대장에 기록하고, 이력을 조회할 수 있는 기능

### 발행대장 파일
- 파일명: `발행대장_YYYY.xlsx`
- 위치: 프로젝트 루트

### 대장 컬럼
| 컬럼 | 설명 | 예시 |
|------|------|------|
| 발급번호 | 영수증 번호 | 26-001 |
| 이름 | 기부자명 | 강신애 |
| 연간총합 | 헌금 총액 | 450,000 |
| 발행일시 | 발행 시간 | 2026-01-20 18:30:00 |
| 파일경로 | 생성된 파일 | receipts/기부금영수증_강신애.docx |
| 비고 | 재발행 등 | 재발행 |

### 새 옵션
```bash
python generate_receipts.py --history           # 발행 이력 조회
python generate_receipts.py --history -n 강신애  # 특정인 이력
```

### 구현 태스크
- [x] 발행대장 Excel 생성 함수 작성
- [x] 발행대장 업데이트 함수 작성
- [x] 발행 시 자동 기록 로직 추가
- [x] `--history` 옵션 추가
- [x] 특정인 이력 필터링 기능

---

## 2. 연도 자동 설정

### 개요
데이터 파일명에서 연도를 자동 추출하여 발급번호와 관련 설정을 자동화

### 연도 규칙
| 항목 | 규칙 | 예시 |
|------|------|------|
| 데이터 연도 | 파일명에서 추출 | 2025_income_summary.xlsx → 2025 |
| 발급 연도 | 데이터연도 + 1 | 2025 → 26 |
| 발급번호 | YY-NNN | 26-001 |

### 새 옵션
```bash
python generate_receipts.py                              # 자동 감지
python generate_receipts.py --year 2025                  # 수동 지정
python generate_receipts.py --data 2024_income_summary.xlsx  # 다른 파일 사용
```

### 구현 태스크
- [x] 파일명에서 연도 추출 함수 작성
- [x] `--year` 옵션 추가
- [x] `--data` 옵션 추가
- [x] 발급번호 연도 동적 생성 로직
- [x] 기본 데이터 파일 자동 탐지 (최신 연도)

---

## 문서 업데이트 태스크

- [x] README.md에 새 옵션 추가
- [x] 기부금영수증_발행_프롬프트.md 업데이트

---

## 검증 방법

```bash
# 1. 연도 자동 감지 테스트
python generate_receipts.py --list

# 2. 특정인 발행 및 이력 확인
python generate_receipts.py -n 강신애
python generate_receipts.py --history

# 3. 발행대장 파일 확인
open 발행대장_2026.xlsx
```
